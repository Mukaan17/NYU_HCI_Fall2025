import React from 'react';
import { Svg, Path, G, Defs, LinearGradient, Stop, Circle } from 'react-native-svg';

/**
 * Reusable SVG Icon Component
 * Renders SVG icons with dynamic color support
 * 
 * @param {string} name - Icon name: 'home', 'chat', 'map', 'safety', 'clock', 'temp'
 * @param {string} color - Color for the icon (default: white)
 * @param {number} size - Size of the icon (default: 24)
 * @param {object} style - Additional styles
 */
export default function SvgIcon({ name, color = '#FFFFFF', size = 24, style }) {
  // Map of SVG paths by icon name
  const iconPaths = {
    home: {
      viewBox: '0 0 23.6816 20.5566',
      paths: [
        'M8.82812 19.5312L14.4922 19.5312L14.4922 13.2227C14.4922 12.7734 14.1992 12.4805 13.75 12.4805L9.58008 12.4805C9.13086 12.4805 8.82812 12.7734 8.82812 13.2227ZM0.839844 10.4297C1.11328 10.4297 1.33789 10.2832 1.54297 10.1172L11.3184 1.9043C11.4258 1.81641 11.5527 1.76758 11.6602 1.76758C11.7773 1.76758 11.8945 1.81641 12.002 1.9043L21.7871 10.1172C21.9824 10.2832 22.207 10.4297 22.4805 10.4297C23.0078 10.4297 23.3203 10.0488 23.3203 9.64844C23.3203 9.42383 23.2324 9.18945 23.0078 9.01367L12.832 0.46875C12.4609 0.15625 12.0605 0 11.6602 0C11.2598 0 10.8594 0.15625 10.4883 0.46875L0.3125 9.01367C0.0976562 9.18945 0 9.42383 0 9.64844C0 10.0488 0.3125 10.4297 0.839844 10.4297ZM18.0176 5.24414L20.4688 7.31445L20.4688 2.91016C20.4688 2.48047 20.1953 2.20703 19.7656 2.20703L18.7207 2.20703C18.3008 2.20703 18.0176 2.48047 18.0176 2.91016ZM5.05859 20.5371L18.2715 20.5371C19.6582 20.5371 20.4688 19.7461 20.4688 18.3789L20.4688 7.55859L18.8965 6.49414L18.8965 17.9883C18.8965 18.623 18.5547 18.9648 17.9395 18.9648L5.39062 18.9648C4.76562 18.9648 4.42383 18.623 4.42383 17.9883L4.42383 6.50391L2.85156 7.55859L2.85156 18.3789C2.85156 19.7559 3.66211 20.5371 5.05859 20.5371Z',
      ],
    },
    chat: {
      viewBox: '0 0 25.2246 23.9355',
      paths: [
        'M16.4716 2.30215C16.1973 2.74651 15.9993 3.24151 15.8901 3.76792C14.8369 3.46736 13.6741 3.31055 12.4316 3.31055C6.68945 3.31055 2.64648 6.66016 2.64648 11.2402C2.64648 12.7441 3.07617 14.1211 3.85742 15.2539C4.48242 16.1914 4.74609 16.9824 4.74609 17.7051C4.74609 18.2129 4.60938 18.6035 4.4043 18.9453C4.90234 18.8379 5.39062 18.6133 5.81055 18.3496C6.40625 17.998 6.85547 17.9199 7.48047 18.1934C8.89648 18.8281 10.5664 19.1797 12.4316 19.1797C18.1738 19.1797 22.2168 15.8203 22.2168 11.2402C22.2168 10.5336 22.1205 9.85618 21.9259 9.22043C22.4449 9.05531 22.9261 8.8008 23.3486 8.47193C23.639 9.33512 23.7891 10.2634 23.7891 11.2402C23.7891 16.748 18.9941 20.752 12.4316 20.752C10.3711 20.752 8.44727 20.3613 6.79688 19.6387C5.79102 20.332 4.43359 20.752 3.21289 20.752C2.19727 20.752 1.79688 19.6875 2.56836 19.0332C3.01758 18.6426 3.17383 18.2227 3.17383 17.7051C3.17383 17.3047 3.00781 16.8262 2.54883 16.1426C1.61133 14.7656 1.07422 13.0664 1.07422 11.2402C1.07422 5.71289 5.86914 1.73828 12.4316 1.73828C13.8766 1.73828 15.2365 1.93154 16.4716 2.30215Z',
        'M20.5078 8.11523C22.3535 8.11523 23.8965 6.5918 23.8965 4.73633C23.8965 2.87109 22.3535 1.34766 20.5078 1.34766C18.6523 1.34766 17.1191 2.87109 17.1191 4.73633C17.1191 6.5918 18.6523 8.11523 20.5078 8.11523Z',
      ],
    },
    map: {
      viewBox: '0 0 18.9062 24.6777',
      paths: [
        'M18.5449 18.7793C18.5449 21.2988 14.707 23.0566 9.28711 23.0566C3.85742 23.0566 0 21.2988 0 18.7793C0 16.6828 2.69157 15.1111 6.74805 14.6546L6.74805 15.4199C6.74805 15.7026 6.75547 15.9727 6.77277 16.2258C3.94799 16.5951 1.99219 17.5852 1.99219 18.7793C1.99219 20.3223 5.17578 21.5137 9.27734 21.5137C13.3594 21.5137 16.5625 20.3027 16.5625 18.7793C16.5625 17.5913 14.5894 16.5958 11.7629 16.2253C11.7799 15.9724 11.7871 15.7025 11.7871 15.4199L11.7871 14.651C15.8522 15.1024 18.5449 16.6771 18.5449 18.7793Z',
        'M12.9395 5.29297C12.9395 7.01172 11.7676 8.45703 10.1758 8.84766L10.1758 15.0293C10.1758 17.9199 9.66797 19.4824 9.27734 19.4824C8.87695 19.4824 8.36914 17.9102 8.36914 15.0293L8.36914 8.84766C6.77734 8.44727 5.60547 7.01172 5.60547 5.29297C5.60547 3.27148 7.23633 1.61133 9.27734 1.61133C11.3086 1.61133 12.9395 3.27148 12.9395 5.29297ZM6.97266 4.22852C6.97266 4.91211 7.55859 5.49805 8.22266 5.49805C8.91602 5.49805 9.48242 4.91211 9.48242 4.22852C9.48242 3.55469 8.91602 2.97852 8.22266 2.97852C7.55859 2.97852 6.97266 3.55469 6.97266 4.22852Z',
      ],
    },
    safety: {
      viewBox: '0 0 16.5918 20.2441',
      paths: [
        'M0 12.0508C0 15.6152 1.91406 16.9238 7.46094 20.0488C7.71484 20.1855 7.95898 20.2441 8.11523 20.2441C8.27148 20.2441 8.52539 20.1855 8.76953 20.0488C14.3262 16.9336 16.2305 15.6152 16.2305 12.0508L16.2305 4.58008C16.2305 3.55469 15.791 3.23242 14.9609 2.88086C13.8086 2.40234 10.0879 1.06445 8.93555 0.664062C8.67188 0.576172 8.38867 0.517578 8.11523 0.517578C7.8418 0.517578 7.55859 0.595703 7.30469 0.664062C6.15234 0.996094 2.42188 2.41211 1.26953 2.88086C0.449219 3.22266 0 3.55469 0 4.58008ZM8.32031 18.4375L8.32031 2.11914C8.36914 2.12891 8.42773 2.14844 8.50586 2.17773C9.98047 2.76367 12.8418 3.79883 14.3555 4.31641C14.6191 4.41406 14.6777 4.55078 14.6777 4.88281L14.6777 11.6895C14.6777 14.707 13.2324 15.498 8.7207 18.2422C8.57422 18.3398 8.4375 18.4082 8.32031 18.4375Z',
      ],
    },
    clock: {
      viewBox: '0 0 29.6094 22.8027',
      paths: [
        'M24.5305 10.3273C24.1359 10.2465 23.7277 10.2051 23.3105 10.2051C19.8633 10.2051 17.0215 13.0469 17.0215 16.5039C17.0215 18.0501 17.5848 19.4699 18.5181 20.5664C17.3232 21.0757 16.0087 21.3574 14.6289 21.3574C9.14062 21.3574 4.66797 16.8848 4.66797 11.3965C4.66797 5.89844 9.14062 1.43555 14.6289 1.43555C19.7655 1.43555 23.9986 5.33092 24.5305 10.3273ZM13.9453 5.18555L13.9453 11.0938L9.52148 11.0938C9.13086 11.0938 8.83789 11.3867 8.83789 11.7676C8.83789 12.1582 9.13086 12.4512 9.52148 12.4512L14.6191 12.4512C15 12.4512 15.3027 12.1582 15.3027 11.7676L15.3027 5.18555C15.3027 4.80469 15 4.51172 14.6191 4.51172C14.2383 4.51172 13.9453 4.80469 13.9453 5.18555Z',
        'M28.2715 16.5039C28.2715 19.2188 26.0059 21.4648 23.3105 21.4648C20.5957 21.4648 18.3496 19.2383 18.3496 16.5039C18.3496 13.7891 20.5957 11.543 23.3105 11.543C26.0352 11.543 28.2715 13.7793 28.2715 16.5039ZM25.0781 14.3066L22.6953 17.6074L21.4941 16.3086C21.3965 16.2012 21.2402 16.1035 21.0254 16.1035C20.6934 16.1035 20.4199 16.3672 20.4199 16.7188C20.4199 16.8555 20.4688 17.0312 20.5762 17.1582L22.2363 18.9746C22.3633 19.1113 22.5586 19.1797 22.7246 19.1797C22.9395 19.1797 23.1348 19.0918 23.2324 18.9453L26.0742 15.0098C26.1621 14.8828 26.2109 14.7461 26.2109 14.6387C26.2109 14.2969 25.918 14.0332 25.5957 14.0332C25.3711 14.0332 25.1953 14.1406 25.0781 14.3066Z',
      ],
    },
    temp: {
      viewBox: '0 0 10.5664 21.7285',
      paths: [
        'M5.11719 21.6992C7.91992 21.6992 10.2051 19.4141 10.2051 16.6016C10.2051 15.1172 9.59961 13.8184 8.42773 12.7637C8.21289 12.5781 8.17383 12.4609 8.17383 12.168L8.17383 3.33984C8.17383 1.35742 6.93359 0 5.11719 0C3.28125 0 2.03125 1.35742 2.03125 3.33984L2.03125 12.168C2.03125 12.4609 1.99219 12.5781 1.77734 12.7637C0.605469 13.8184 0 15.1172 0 16.6016C0 19.4141 2.28516 21.6992 5.11719 21.6992ZM5.11719 20.2832C3.07617 20.2832 1.42578 18.623 1.42578 16.6016C1.42578 15.3809 2.01172 14.2773 3.04688 13.584C3.34961 13.3789 3.4668 13.1934 3.4668 12.793L3.4668 3.39844C3.4668 2.22656 4.13086 1.43555 5.11719 1.43555C6.07422 1.43555 6.73828 2.22656 6.73828 3.39844L6.73828 12.793C6.73828 13.1934 6.85547 13.3789 7.1582 13.584C8.19336 14.2773 8.7793 15.3809 8.7793 16.6016C8.7793 18.623 7.12891 20.2832 5.11719 20.2832Z',
        'M5.10742 18.9648C6.40625 18.9648 7.46094 17.9102 7.46094 16.5918C7.46094 15.6738 6.95312 14.9219 6.20117 14.5117C5.87891 14.3457 5.77148 14.2285 5.77148 13.75L5.77148 10.3809C5.77148 10.0098 5.46875 9.70703 5.10742 9.70703C4.73633 9.70703 4.43359 10.0098 4.43359 10.3809L4.43359 13.75C4.43359 14.2285 4.32617 14.3457 4.00391 14.5117C3.25195 14.9219 2.74414 15.6738 2.74414 16.5918C2.74414 17.9102 3.79883 18.9648 5.10742 18.9648ZM5.10742 8.73047C5.46875 8.73047 5.77148 8.42773 5.77148 8.05664C5.77148 7.68555 5.46875 7.38281 5.10742 7.38281C4.73633 7.38281 4.43359 7.68555 4.43359 8.05664C4.43359 8.42773 4.73633 8.73047 5.10742 8.73047ZM5.10742 6.39648C5.46875 6.39648 5.77148 6.09375 5.77148 5.72266C5.77148 5.35156 5.46875 5.04883 5.10742 5.04883C4.73633 5.04883 4.43359 5.35156 4.43359 5.72266C4.43359 6.09375 4.73633 6.39648 5.10742 6.39648ZM5.10742 4.07227C5.46875 4.07227 5.77148 3.76953 5.77148 3.39844C5.77148 3.02734 5.46875 2.72461 5.10742 2.72461C4.73633 2.72461 4.43359 3.02734 4.43359 3.39844C4.43359 3.76953 4.73633 4.07227 5.10742 4.07227Z',
      ],
    },
    icon: {
      viewBox: '0 0 100 100',
      hasGradients: true,
      paths: [
        { type: 'circle', opacity: 0.04, d: 'M50 92C73.196 92 92 73.196 92 50C92 26.804 73.196 8 50 8C26.804 8 8 26.804 8 50C8 73.196 26.804 92 50 92Z' },
        { type: 'path', stroke: true, gradient: 'gradient1', d: 'M25 20L50 70' },
        { type: 'path', stroke: true, gradient: 'gradient2', d: 'M50 70L75 20' },
        { type: 'circle', opacity: 0.8, fill: true, d: 'M50 74C52.2091 74 54 72.2091 54 70C54 67.7909 52.2091 66 50 66C47.7909 66 46 67.7909 46 70C46 72.2091 47.7909 74 50 74Z' },
      ],
    },
  };

  const iconData = iconPaths[name];

  if (!iconData) {
    console.warn(`SvgIcon: Unknown icon name: ${name}`);
    return null;
  }

  // Extract opacity from color if it's rgba, otherwise use 1
  let opacity = 1;
  let baseColor = color;
  
  if (color.includes('rgba')) {
    const match = color.match(/rgba?\([^)]+\)/);
    if (match) {
      const rgbaMatch = match[0].match(/[\d.]+/g);
      if (rgbaMatch && rgbaMatch.length >= 4) {
        opacity = parseFloat(rgbaMatch[3]);
        baseColor = `rgb(${rgbaMatch[0]}, ${rgbaMatch[1]}, ${rgbaMatch[2]})`;
      }
    }
  }

  // Special handling for app icon with gradients
  if (name === 'icon' && iconData.hasGradients) {
    return (
      <Svg
        width={size}
        height={size}
        viewBox={iconData.viewBox}
        style={style}
      >
        <Defs>
          <LinearGradient id="gradient1" x1="25" y1="20" x2="50" y2="70" gradientUnits="userSpaceOnUse">
            <Stop offset="0" stopColor="#6C63FF" />
            <Stop offset="1" stopColor="#8B7FFF" />
          </LinearGradient>
          <LinearGradient id="gradient2" x1="50" y1="70" x2="75" y2="20" gradientUnits="userSpaceOnUse">
            <Stop offset="0" stopColor="#68D4FF" />
            <Stop offset="1" stopColor="#8DD8FF" />
          </LinearGradient>
          <LinearGradient id="gradient0" x1="8" y1="8" x2="92" y2="92" gradientUnits="userSpaceOnUse">
            <Stop offset="0" stopColor="#6C63FF" />
            <Stop offset="1" stopColor="#8B7FFF" />
          </LinearGradient>
        </Defs>
        <G>
          {iconData.paths.map((item, index) => {
            if (item.type === 'circle') {
              // Parse circle from path data (M50 92C73.196 92 92 73.196 92 50C92 26.804 73.196 8 50 8C26.804 8 8 26.804 8 50C8 73.196 26.804 92 50 92Z)
              // For the background circle, we'll use a simple circle
              if (index === 0) {
                return (
                  <Circle
                    key={index}
                    cx="50"
                    cy="50"
                    r="42"
                    fill="url(#gradient0)"
                    fillOpacity={item.opacity || 0.04}
                  />
                );
              } else {
                // Small circle at bottom
                return (
                  <Circle
                    key={index}
                    cx="50"
                    cy="70"
                    r="4"
                    fill="white"
                    fillOpacity={item.opacity || 0.8}
                  />
                );
              }
            } else if (item.type === 'path' && item.stroke) {
              return (
                <Path
                  key={index}
                  d={item.d}
                  stroke={item.gradient ? `url(#${item.gradient})` : baseColor}
                  strokeWidth="10"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  fill="none"
                />
              );
            } else {
              return (
                <Path
                  key={index}
                  d={item.d}
                  fill={baseColor}
                  fillOpacity={opacity}
                />
              );
            }
          })}
        </G>
      </Svg>
    );
  }

  // Standard icon rendering
  return (
    <Svg
      width={size}
      height={size}
      viewBox={iconData.viewBox}
      style={style}
    >
      <G>
        {iconData.paths.map((path, index) => (
          <Path
            key={index}
            d={path}
            fill={baseColor}
            fillOpacity={opacity}
          />
        ))}
      </G>
    </Svg>
  );
}


